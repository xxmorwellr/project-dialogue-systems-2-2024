{"version":3,"file":"AudioContextConsumer.js","names":["audioContext","suspend","playingUtterance","emit","resume","queue","AudioContext","Error","utterance","shift","play","close","stop"],"sources":["../../../src/BingSpeech/TextToSpeech/AudioContextConsumer.js"],"sourcesContent":["export default class {\n  pause() {\n    this.audioContext && this.audioContext.suspend();\n    this.playingUtterance && this.playingUtterance.emit('pause');\n  }\n\n  resume() {\n    this.audioContext && this.audioContext.resume();\n    this.playingUtterance && this.playingUtterance.emit('resume');\n  }\n\n  async start(queue, { AudioContext }) {\n    if (this.audioContext) {\n      throw new Error('already started');\n    }\n\n    let utterance;\n\n    try {\n      while ((utterance = queue.shift())) {\n        this.playingUtterance = utterance;\n\n        await utterance.play(this.audioContext || (this.audioContext = new AudioContext()));\n\n        this.playingUtterance = null;\n      }\n    } finally {\n      await this.audioContext && this.audioContext.close();\n    }\n  }\n\n  stop() {\n    this.playingUtterance && this.playingUtterance.stop();\n\n    if (this.audioContext) {\n      // Play -> Pause -> Cancel (stop)\n      // This would generate these events: \"start\", \"pause\", \"end\"\n\n      // Without this code, the \"end\" event will not emit until resume() is called\n      // Cancelling an unstarted utterance will not emit any \"start\" or \"end\" event\n      this.audioContext.close();\n      this.audioContext = null;\n    }\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;WACE,iBAAQ;MACN,KAAKA,YAAL,IAAqB,KAAKA,YAAL,CAAkBC,OAAlB,EAArB;MACA,KAAKC,gBAAL,IAAyB,KAAKA,gBAAL,CAAsBC,IAAtB,CAA2B,OAA3B,CAAzB;IACD;;;WAED,kBAAS;MACP,KAAKH,YAAL,IAAqB,KAAKA,YAAL,CAAkBI,MAAlB,EAArB;MACA,KAAKF,gBAAL,IAAyB,KAAKA,gBAAL,CAAsBC,IAAtB,CAA2B,QAA3B,CAAzB;IACD;;;;2FAED,iBAAYE,KAAZ;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAqBC,YAArB,QAAqBA,YAArB;;gBAAA,KACM,KAAKN,YADX;kBAAA;kBAAA;gBAAA;;gBAAA,MAEU,IAAIO,KAAJ,CAAU,iBAAV,CAFV;;cAAA;gBAAA;;cAAA;gBAAA,MAQYC,SAAS,GAAGH,KAAK,CAACI,KAAN,EARxB;kBAAA;kBAAA;gBAAA;;gBASM,KAAKP,gBAAL,GAAwBM,SAAxB;gBATN;gBAAA,OAWYA,SAAS,CAACE,IAAV,CAAe,KAAKV,YAAL,KAAsB,KAAKA,YAAL,GAAoB,IAAIM,YAAJ,EAA1C,CAAf,CAXZ;;cAAA;gBAaM,KAAKJ,gBAAL,GAAwB,IAAxB;gBAbN;gBAAA;;cAAA;gBAAA;gBAAA;gBAAA,OAgBU,KAAKF,YAhBf;;cAAA;gBAAA;;gBAAA;kBAAA;kBAAA;gBAAA;;gBAgB+B,KAAKA,YAAL,CAAkBW,KAAlB,EAhB/B;;cAAA;gBAAA;;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,C;;;;;;;;;;WAoBA,gBAAO;MACL,KAAKT,gBAAL,IAAyB,KAAKA,gBAAL,CAAsBU,IAAtB,EAAzB;;MAEA,IAAI,KAAKZ,YAAT,EAAuB;QACrB;QACA;QAEA;QACA;QACA,KAAKA,YAAL,CAAkBW,KAAlB;QACA,KAAKX,YAAL,GAAoB,IAApB;MACD;IACF"}