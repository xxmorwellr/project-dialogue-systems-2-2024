{"version":3,"file":"AudioContextConsumer.js","names":["audioContext","suspend","playingUtterance","dispatchEvent","CustomEvent","resume","queue","utterance","shift","play","stop","state"],"sources":["../../../src/SpeechServices/TextToSpeech/AudioContextConsumer.js"],"sourcesContent":["/* eslint no-await-in-loop: \"off\" */\n\nexport default class {\n  constructor(audioContext) {\n    this.audioContext = audioContext;\n  }\n\n  pause() {\n    this.audioContext && this.audioContext.suspend();\n    this.playingUtterance && this.playingUtterance.dispatchEvent(new CustomEvent('pause'));\n  }\n\n  resume() {\n    this.audioContext && this.audioContext.resume();\n    this.playingUtterance && this.playingUtterance.dispatchEvent(new CustomEvent('resume'));\n  }\n\n  async start(queue) {\n    let utterance;\n\n    while ((utterance = queue.shift())) {\n      this.playingUtterance = utterance;\n\n      await utterance.play(this.audioContext);\n\n      this.playingUtterance = null;\n    }\n  }\n\n  stop() {\n    this.playingUtterance && this.playingUtterance.stop();\n\n    if (this.audioContext.state === 'suspended') {\n      // Play -> Pause -> Cancel (stop)\n      // This would generate these events: \"start\", \"pause\", \"end\"\n\n      // Without this code, the \"end\" event will not emit until resume() is called\n      // Cancelling an unstarted utterance will not emit any \"start\" or \"end\" event\n      this.audioContext.resume();\n    }\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;AAAA;;EAGE,kBAAYA,YAAZ,EAA0B;IAAA;IACxB,KAAKA,YAAL,GAAoBA,YAApB;EACD;;;;WAED,iBAAQ;MACN,KAAKA,YAAL,IAAqB,KAAKA,YAAL,CAAkBC,OAAlB,EAArB;MACA,KAAKC,gBAAL,IAAyB,KAAKA,gBAAL,CAAsBC,aAAtB,CAAoC,IAAIC,WAAJ,CAAgB,OAAhB,CAApC,CAAzB;IACD;;;WAED,kBAAS;MACP,KAAKJ,YAAL,IAAqB,KAAKA,YAAL,CAAkBK,MAAlB,EAArB;MACA,KAAKH,gBAAL,IAAyB,KAAKA,gBAAL,CAAsBC,aAAtB,CAAoC,IAAIC,WAAJ,CAAgB,QAAhB,CAApC,CAAzB;IACD;;;;2FAED,iBAAYE,KAAZ;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,MAGUC,SAAS,GAAGD,KAAK,CAACE,KAAN,EAHtB;kBAAA;kBAAA;gBAAA;;gBAII,KAAKN,gBAAL,GAAwBK,SAAxB;gBAJJ;gBAAA,OAMUA,SAAS,CAACE,IAAV,CAAe,KAAKT,YAApB,CANV;;cAAA;gBAQI,KAAKE,gBAAL,GAAwB,IAAxB;gBARJ;gBAAA;;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,C;;;;;;;;;;WAYA,gBAAO;MACL,KAAKA,gBAAL,IAAyB,KAAKA,gBAAL,CAAsBQ,IAAtB,EAAzB;;MAEA,IAAI,KAAKV,YAAL,CAAkBW,KAAlB,KAA4B,WAAhC,EAA6C;QAC3C;QACA;QAEA;QACA;QACA,KAAKX,YAAL,CAAkBK,MAAlB;MACD;IACF"}